module texturedcube

pipeline Draw(mvp: fmat4, tex: sampler2D): fvec4 {

  def vertex(pos: fvec3, uv: fvec2): fvec2 {
    builtin.position = mvp * fvec4(pos, 1.0)
    return uv
  }

  def fragment(uv: fvec2): fvec4 {
    return texture(tex, uv)
  }
}

renderer Main() {

  def main(cube: atom) {
    builtin.screen = fvec4(0.6, 0.6, 0.6, 1.0)
    builtin.screen += Draw(mvp=cube, tex=cube, pos=cube, uv=cube)
  }
}
